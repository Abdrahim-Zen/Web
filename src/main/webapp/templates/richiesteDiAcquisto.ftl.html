<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Le tue richieste di acquisto</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
          crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="style/richiesteDiAcquisto.css"/>
</head>

<body>
<div class="container mt-4">
    <#include "header.ftl.html">

    <h2>Le tue richieste di acquisto</h2>

    <table>
        <thead>
        <tr>
            <th>ID Richiesta</th>
            <th>Importo</th>
            <th>Note</th>
            <th>Stato</th>
            <th>Data Inserimento</th>
            <th></th>
        </tr>
        </thead>

        <tbody>

        <#list richieste as r>


            <tr>
                <td>${r.key}</td>
                <td>â‚¬${r.importo}</td>
                <td>${r.note!""}</td>
                <td>${r.stato}</td>
                <td>${r.dataInserimento?string("dd/MM/yyyy")}</td>
                <td class="text-end">
                    <button class="btn btn-sm btn-outline-primary"
                            data-bs-toggle="collapse"
                            data-bs-target="#spec-${r.key}">
                        Dettagli
                    </button>
                </td>
            </tr>

            <tr>
                <td colspan="6" class="p-0">
                    <div id="spec-${r.key}" class="collapse">
                        <div class="p-3">

                            <#assign specificheKey = "specificheRichiesta_" + r.key>
                            <#if .data_model[specificheKey]??>
                                <#assign specificheRichiesta = .data_model[specificheKey]>

                                <#if specificheRichiesta?has_content>
                                    <strong>Specifiche richieste:</strong>

                                    <table class="table table-sm table-bordered mt-2 mb-0">
                                        <thead>
                                        <tr>
                                            <th>Caratteristica</th>
                                            <th>Valore richiesto</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <#list specificheRichiesta as spec>
                                            <tr>
                                                <td>${spec.nome_specifica}</td>
                                                <td>${spec.valore}</td>
                                            </tr>
                                        </#list>
                                        </tbody>
                                    </table>
                                <#else>
                                    <em>Nessuna specifica presente</em>
                                </#if>
                            </#if>

                        </div>
                    </div>
                </td>
            </tr>

        </#list>

        <#if richieste?size == 0>
            <tr>
                <td colspan="6">Nessuna richiesta trovata</td>
            </tr>
        </#if>

        </tbody>
    </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
